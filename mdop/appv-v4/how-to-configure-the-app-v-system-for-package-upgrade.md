---
title: 如何为程序包升级配置 App-V System
description: 如何为程序包升级配置 App-V System
author: dansimp
ms.assetid: de133898-f887-46c1-9bc9-fbb03feac66a
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, appcompat, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 06/16/2016
ms.openlocfilehash: 5e5056f923c61aff39d9bd6e1d26f071177f7c12
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/26/2020
ms.locfileid: "10801580"
---
# 如何为程序包升级配置 App-V System


当你部署已在 App-v Sequencer 中升级的现有应用程序包的新版本时，你可以部署它，以便应用 V 客户端将新版本自动传输到本地缓存。 根据你使用的流式处理解决方案，配置程序包升级有不同的过程。 以下部分介绍了发布和流式处理的最典型方案，并包括为每个方案配置程序包升级所需的过程。

## 对发布和流式处理使用管理服务器


在此方案中，单个 App-v 管理服务器用于程序包和应用程序的发布和流处理，并且需要 RTSP 协议。 将原始程序包导入到 app-v 管理服务器时，管理员会将包含由 sequencer 创建的文件的程序包文件夹复制到 "内容" 文件夹，例如 \\\\server\\CONTENT\\packagename。 管理员还可以编辑 OSD 文件中的 HREF 条目，以指向程序包文件夹中的 SFT 文件，然后将程序包导入到服务器。

当用户通过管理服务器进行身份验证时，服务器将通过向客户端发送 applist.xml 文件来发布用户的应用程序。 然后，客户端从管理服务器检索应用程序的 OSD 文件和图标。 当用户双击应用程序图标时，应用程序内容将从 OSD 文件中指定的路径传输到客户端缓存，并启动应用程序。

### 升级程序包

若要在 App-v Sequencer 中添加已升级的应用程序的新版本，管理员必须将新的 SFT 文件和任何其他已修改的文件复制到与应用程序的原始版本相同的文件夹中。 管理员随后将使用服务器管理控制台中的 "**添加版本**" 添加程序包的新版本。

当用户下一次启动应用程序时，服务器会自动将新版本流到客户端。 此特定的升级程序包的方法以前称为 "活动升级"。

## 使用管理服务器发布和流式处理服务器进行流处理


在此方案中，app-v 管理服务器用于发布程序包，而流式处理服务器用于流式处理程序包和应用程序。 需要 RTSP 协议。 将原始程序包导入管理服务器时，管理员会将包含由 sequencer 创建的文件的程序包文件夹复制到 "内容" 文件夹中，例如 "\\\\server\\CONTENT\\packagename."。 管理员编辑 OSD 文件中的 HREF 条目，以指向流服务器上的 SFT 文件，然后将程序包导入到管理服务器。

若要设置流式服务器，管理员将程序包文件夹从管理服务器复制到流服务器上的内容文件夹。 此文件夹在流服务器的内容文件夹下的名称和相对路径必须与管理服务器上的名称和相对路径相同，例如，\\\\streamingserver\\CONTENT\\packagename。

如果客户端的 "应用程序源根（ASR）" 设置配置为指向流服务器，客户端将使用此设置，而不是在 OSD 文件中的 HREF 条目中使用服务器名称。 客户端上的 ISR 和 OSR 字段可以配置为指向管理服务器或流式服务器，具体取决于所使用的特定系统体系结构。

当用户通过管理服务器进行身份验证时，服务器将通过向客户端发送 applist.xml 文件来发布用户的应用程序。 客户端从流式服务器或管理服务器检索应用程序的 OSD 文件和图标，具体取决于 OSR 和 ISR 字段中的设置。

当用户双击应用程序图标时，客户端将使用包含在 OSD 文件 HREF 元素中的程序包内容文件（SFT）的路径。 如果使用 ASR，客户将使用在 ASR 中指定的流式处理服务器的路径替换 HREF 元素中的服务器名称（以及端口和协议，如果使用）。 然后，应用程序从流服务器传输到客户端缓存并启动。

### 升级程序包

若要在 App-v Sequencer 中添加已升级的应用程序的新版本，管理员必须将新版本的 SFT 文件和任何其他已修改的文件复制到与流服务器上的应用程序的原始版本相同的文件夹中。

为保持一致性，建议将新文件复制到管理服务器上的文件夹。 尤其是，如果你使用客户端的 OSR 或 ISR 字段，请将更新的 OSD 文件和图标复制到 OSR 和 ISR 字段中指定的服务器。

流服务器检测到新版本后，下次用户启动应用程序时，服务器会自动将新版本流到客户端。

## 使用用于发布的管理服务器和用于流式处理的 IIS 服务器


在此方案中，app-v 管理服务器用于发布程序包，而 IIS 服务器用于流式处理程序包和应用程序。 将原始程序包导入管理服务器时，管理员会将包含由 sequencer 创建的文件的程序包文件夹复制到 "内容" 文件夹中，例如 "\\\\server\\CONTENT\\packagename."。 管理员编辑 OSD 文件中的 HREF 条目，使其指向 IIS 服务器上的 SFT 文件，然后将程序包导入管理服务器。

若要设置用于流式处理的 IIS 服务器，管理员将程序包文件夹从管理服务器复制到 IIS 服务器上的内容文件夹。 在管理服务器上，此文件夹必须具有与 IIS 服务器的 Web 内容文件夹相同的名称和相对路径;例如，可以使用 or 访问 IIS 服务器上的 URL http://IISserver/CONTENT/packagename https://IISserver/CONTENT/packagename 。

如果客户端的 "应用程序源根（ASR）" 设置配置为指向 IIS 服务器，客户端将在 OSD 文件的 HREF 条目中使用 ASR，而不是服务器名称。 你可以选择将客户端上的 ISR 和 OSR 字段配置为指向管理服务器或 IIS 服务器，具体取决于你使用的特定系统体系结构。

当管理服务器对用户进行身份验证时，服务器将通过向客户端发送 applist.xml 文件来发布用户的应用程序。 客户端从 IIS 服务器或管理服务器检索应用程序的 OSD 文件和图标，具体取决于 ISR 和 OSR 字段中的设置。

当用户双击应用程序图标时，客户端将使用包含在 OSD 文件 HREF 元素中的程序包内容文件（SFT）的路径。 如果使用 ASR，客户端会将 HREF 元素中的服务器名称（以及端口和协议，如果使用）替换为在 ASR 中指定的 IIS 服务器的路径。 然后，使用 HTTP （S）协议将应用程序从 IIS 服务器传输到客户端缓存，并启动该应用程序。

### 升级程序包

升级程序包的过程如下所示：

-   将新版本的 OSD 文件复制到管理服务器的内容文件夹下的原始版本的文件夹（例如 \\\\server\\CONTENT\\packagename），并替换现有的 OSD 文件。 为了保持一致性，还应复制任何其他已修改的文件。 如果使用客户端的 OSR 或 ISR 字段，则还会将更新的 OSD 文件和图标复制到 "OSR" 和 "ISR" 字段中指定的服务器。

-   将新版本的 SFT 文件复制到 IIS 服务器上 "Web 内容" 文件夹下的 "软件包" 文件夹中;例如，可以使用 or 访问 IIS 服务器上的 URL http://IISserver/CONTENT/packagename https://IISserver/CONTENT/packagename 。

下一次发布刷新时，客户端将更新为新版本的 OSD 文件。 此文件现在指向 SFT 文件的新版本;因此，当用户下次双击应用程序图标时，将启动新版本。

## 使用管理服务器发布和用于流式处理的文件共享


在此方案中，app-v 管理服务器用于发布程序包，文件服务器用于流式处理程序包和应用程序。 将原始程序包导入管理服务器时，管理员会将包含由 sequencer 创建的文件的程序包文件夹复制到 "内容" 文件夹中，例如 "\\\\server\\CONTENT\\packagename."。 管理员编辑 OSD 文件中的 HREF 条目，以使其指向文件服务器上的 SFT 文件，并将程序包导入到管理服务器。

若要设置用于流处理的文件服务器，管理员将程序包文件夹从管理服务器复制到文件服务器上的内容文件夹。 此文件夹在管理服务器上的文件服务器内容文件夹下必须具有相同的名称和相对路径，例如 \\\\fileserver\\CONTENT\\packagename。

如果客户端的应用程序源根（ASR）设置配置为使用 UNC 路径指向文件服务器（例如 \\\\fileserver\\content），客户端将使用此设置，而不是在 OSD 文件中的 HREF 条目中使用服务器名称。 管理员可以选择将客户端上的 ISR 和 OSR 字段配置为指向管理服务器或文件服务器，具体取决于所使用的特定系统体系结构。

当管理服务器对用户进行身份验证时，服务器将通过向客户端发送 applist.xml 文件来发布用户的应用程序。 客户端从文件服务器或管理服务器检索应用程序的 OSD 文件和图标，具体取决于 ISR 和 OSR 字段中的设置。

当用户双击应用程序图标时，客户端将使用包含在 OSD 文件 HREF 元素中的程序包内容文件（SFT）的路径。 如果使用 ASR，客户端将使用在 ASR 中指定的文件服务器的路径替换 HREF 元素中的服务器名称（以及端口和协议，如果使用）。 然后，应用程序从文件服务器传输到客户端缓存并启动。

### 升级程序包

升级程序包的过程如下所示：

-   将新版本的 OSD 文件复制到管理服务器的内容文件夹下的原始版本的文件夹中，例如 \\\\server\\CONTENT\\packagename 替换现有的 OSD 文件。 还应复制任何其他已修改的文件，以便保持一致性。 如果使用客户端的 OSR 或 ISR 字段，则还会将更新的 OSD 文件和图标复制到 "OSR" 和 "ISR" 字段中指定的服务器。

-   将新版本的 SFT 文件复制到文件服务器上 "内容" 文件夹下的程序包文件夹，例如 \\\\fileserver\\CONTENT\\packagename。 将 V2 SFT 文件复制到文件服务器上内容共享下的文件夹，例如 \\\\fileserver\\CONTENT\\packagename\\V1。

下一次发布时，将用新版本的 OSD 文件更新客户端。 此文件现在指向新版本的 SFT 文件，因此当用户下次双击应用程序图标时，将启动新版本。

## 使用 MSI 流模式升级程序包


在对程序包进行排序期间生成 Windows Installer （MSI）文件时，sequencer 将创建一个。MSI 文件，其中包含所有必需的发布信息。 管理员必须复制。MSI 文件到客户端和。将包含程序包内容的 SFT 文件包含在客户端计算机可访问的网络共享中。

若要将应用程序发布到客户端，请在客户端计算机上运行以下命令：

   **Msiexec.exe/i \\\\PathToMsi\\packagename.msi MODE = 流式处理 OVERRIDEURL = \\\\\\\\server\\share\\package.sft**

所.MSI 文件将应用程序发布到客户端，然后将其流式处理。SFT 文件到客户端缓存。

### 升级程序包

若要添加新版本，管理员必须部署新版本。MSI 文件到客户端和新的。SFT 文件到网络共享。 然后，管理员必须运行用于部署程序包的相同命令，但使用 "新建"。MSI 文件和新文件。SFT 文件，例如：

   **Msiexec.exe/i \\\\PathToMsi\\packagename\_2.msi MODE = 流式处理 OVERRIDEURL = \\\\\\\\server\\share\\package\_2.sft**

 

 





