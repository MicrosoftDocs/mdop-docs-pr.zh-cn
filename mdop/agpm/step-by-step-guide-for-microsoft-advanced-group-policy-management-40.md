---
title: Microsoft 高级组策略管理 4.0 分步指南
description: Microsoft 高级组策略管理 4.0 分步指南
author: dansimp
ms.assetid: dc6f9b16-b1d4-48f3-88bb-f29301f0131c
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop
ms.mktglfcycl: manage
ms.sitesec: library
ms.prod: w10
ms.date: 08/30/2016
ms.openlocfilehash: 819d536451095d23080115799016aa0ac5242dee
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/26/2020
ms.locfileid: "10802520"
---
# Microsoft 高级组策略管理 4.0 分步指南


本分步指南介绍了使用组策略管理控制台（GPMC）和 Microsoft 高级组策略管理（AGPM）的组策略管理的高级技术。 AGPM 增加了 GPMC 的功能，提供：

-   将管理组策略对象（Gpo）的权限委派给多个组策略管理员的标准角色，以及委派对生产环境中的 Gpo 的访问权限的功能。

-   用于启用组策略管理员在将 Gpo 部署到生产环境之前脱机创建和修改 Gpo 的存档。

-   回滚到存档中的 GPO 的任何早期版本的功能，并限制存档中存储的版本数。

-   Gpo 的签入和签出功能，以确保组策略管理员不会无意间覆盖彼此的工作。

-   搜索具有特定属性的 Gpo 并筛选所显示的 Gpo 列表的功能。

## AGPM 方案概述


对于此方案，你将为 AGPM 中的每个角色使用单独的用户帐户，演示如何在具有不同级别的权限的多个组策略管理员的环境中管理组策略。 具体地说，你将执行以下任务：

-   使用属于域管理员组成员的帐户，安装 AGPM 服务器并将 AGPM 管理员角色分配给帐户或组。

-   使用您将为其分配 AGPM 角色的帐户，安装 AGPM 客户端。

-   使用具有 AGPM 管理员角色的帐户配置 AGPM 并通过向其他帐户分配角色来委派对 Gpo 的访问权限。

-   从具有 "编辑者" 角色的帐户中，请求创建一个新的 GPO，然后通过使用具有审批者角色的帐户进行审批。 使用编辑器帐户将 GPO 从存档中签出，编辑 GPO，将 GPO 签入存档，然后请求部署。

-   使用具有审批者角色的帐户，查看 GPO 并将其部署到生产环境。

-   使用具有编辑器角色的帐户创建一个 GPO 模板，并将其用作创建新 GPO 的起始点。

-   使用具有审批者角色的帐户，删除和还原 GPO。

![组策略对象开发过程](images/ab77a1f3-f430-4e7d-be58-ee8f9bd1140e.gif)

## 要求


要安装 AGPM 的计算机必须满足以下要求，并且你必须创建用于此方案的帐户。

**注意** 如果已安装了 AGPM 2.5，并且正在从 Windows Server®2003升级到 Windows Server2008R2 或 Windows Server2008，或者从 WindowsVista 升级到 Windows7 或 WindowsVista®使用服务 Pack1 （SP1），则必须升级操作系统，然后才能升级到 AGPM 4.0。

如果安装了 AGPM 3.0，则无需在升级到 AGPM 4.0 之前升级操作系统

 

在包含较新版本和较旧操作系统的混合环境中，功能有一些限制，如下表所示。

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">在其上运行 AGPM 服务器4.0 的操作系统</th>
<th align="left">在其上运行 AGPM 客户端4.0 的操作系统</th>
<th align="left">AGPM 4.0 支持的状态</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><p>Windows Server2008R2 或 Windows7</p></td>
<td align="left"><p>Windows Server2008R2 或 Windows7</p></td>
<td align="left"><p>支持</p></td>
</tr>
<tr class="even">
<td align="left"><p>Windows Server2008R2 或 Windows7</p></td>
<td align="left"><p>Windows Server2008 或 Windows Vista SP1</p></td>
<td align="left"><p>受支持，但不能编辑仅存在于 Windows Server2008R2 或 Windows7 中的策略设置或首选项</p></td>
</tr>
<tr class="odd">
<td align="left"><p>Windows Server2008 或 Windows Vista SP1</p></td>
<td align="left"><p>Windows Server2008R2 或 Windows7</p></td>
<td align="left"><p>不支持</p></td>
</tr>
<tr class="even">
<td align="left"><p>Windows Server2008 或 Windows Vista SP1</p></td>
<td align="left"><p>Windows Server2008 或 Windows Vista SP1</p></td>
<td align="left"><p>受支持，但无法报告或编辑仅存在于 Windows Server2008R2 或 Windows7 中的策略设置或首选项</p></td>
</tr>
</tbody>
</table>

 

### AGPM 服务器要求

AGPM Server 4.0 要求 Windows Server2008R2、Windows Server2008、Windows7 和 GPMC 来自远程服务器管理工具（RSAT），或者 Windows Vista 中安装了来自 RSAT 的 SP1 和 GPMC。 支持32位和64位版本。

在安装 AGPM 服务器之前，您必须是域管理员组的成员，除非另有说明，否则必须存在以下 Windows 功能：

-   GPMC.MSC

    -   Windows Server2008R2 或 Windows Server2008：如果 GPMC 不存在，则由 AGPM 自动安装。

    -   Windows7：安装 AGPM 之前，必须从 RSAT 安装 GPMC。 有关详细信息，请参阅[适用于 Windows 7 的远程服务器管理工具](https://go.microsoft.com/fwlink/?LinkID=131280)（ https://go.microsoft.com/fwlink/?LinkID=131280) 。

    -   Windows Vista with SP1：安装 AGPM 之前，必须从 RSAT 安装 GPMC。 有关详细信息，请参阅[适用于 Windows Vista 的远程服务器管理工具 Service Pack 1](https://go.microsoft.com/fwlink/?LinkID=116179) （ https://go.microsoft.com/fwlink/?LinkID=116179) 。

-   .NET Framework 3.5 或更高版本

    -   Windows Server2008R2 或 Windows7：如果不存在 .NET Framework 3.5 或更高版本，则由 AGPM 自动安装 .NET Framework 3.5。

    -   Windows Server2008 或 Windows Vista SP1：安装 AGPM 之前，必须先安装 .NET Framework 3.5 或更高版本。

AGPM 服务器需要以下 Windows 功能，如果不存在，将自动安装这些功能：

-   WCF 激活;非 HTTP 激活

-   Windows Process Activation Service

    -   流程模型

    -   .NET 环境

    -   配置 Api

### AGPM 客户端要求

AGPM 客户端4.0 要求来自 RSAT 的 Windows Server2008R2、Windows Server2008、Windows7 和 GPMC，或者 Windows Vista SP1 和从 RSAT 安装的 GPMC。 支持32位和64位版本。 可以在运行 AGPM 服务器的计算机上安装 AGPM 客户端。

AGPM 客户端需要以下 Windows 功能，除非另有说明，否则将自动安装这些功能（如果不存在）：

-   GPMC.MSC

    -   Windows Server2008R2 或 Windows Server2008：如果 GPMC 不存在，则由 AGPM 自动安装。

    -   Windows7：安装 AGPM 之前，必须从 RSAT 安装 GPMC。 有关详细信息，请参阅[适用于 Windows 7 的远程服务器管理工具](https://go.microsoft.com/fwlink/?LinkID=131280)（ https://go.microsoft.com/fwlink/?LinkID=131280) 。

    -   Windows Vista with SP1：安装 AGPM 之前，必须从 RSAT 安装 GPMC。 有关详细信息，请参阅[适用于 Windows Vista 的远程服务器管理工具 Service Pack 1](https://go.microsoft.com/fwlink/?LinkID=116179) （ https://go.microsoft.com/fwlink/?LinkID=116179) 。

-   .NET Framework 3.0 或更高版本

    -   Windows Server2008R2 或 Windows7：如果不存在 .NET Framework 3.0 或更高版本，则由 AGPM 自动安装 .NET Framework 3.5。

    -   使用 SP1 的 windows Server2008 或 Windows Vista：如果不存在 .NET Framework 3.0 或更高版本，则由 AGPM 自动安装 .NET Framework 3.0。

### 方案要求

在开始此方案之前，请创建四个用户帐户。 在此方案中，你将为以下每个帐户分配以下 AGPM 角色之一： AGPM 管理员（完全控制）、审批者、编辑者和审阅者。 这些帐户必须能够发送和接收电子邮件。 为具有 AGPM 管理员、审批者和（可选）编辑器角色的帐户分配**链接 gpo**权限。

**注意** 
默认情况下， **Link gpo**权限分配给域管理员和企业管理员的成员。 若要将**链接 gpo**权限分配给其他用户或组（如具有 AGPM 管理员或审批者角色的帐户），请单击域的节点，然后单击 "**委派**" 选项卡，选择 "**链接 Gpo**"，单击 "**添加**"，然后选择要向其分配权限的用户或组。

 

## 安装和配置 AGPM 的步骤


必须完成以下步骤才能安装和配置 AGPM。

[步骤1：安装 AGPM 服务器](#bkmk-config1)

[步骤2：安装 AGPM 客户端](#bkmk-config2)

[步骤3：配置 AGPM 服务器连接](#bkmk-config3)

[步骤4：配置电子邮件通知](#bkmk-config4)

[步骤5：代理访问](#bkmk-config5)

### <a href="" id="bkmk-config1"></a>步骤1：安装 AGPM 服务器

在此步骤中，将在将运行 AGPM 服务的成员服务器或域控制器上安装 AGPM 服务器，然后配置存档。 所有 AGPM 操作都通过此 Windows 服务进行管理，并使用服务凭据执行。 AGPM 服务器托管的存档可以托管在该服务器上，也可以在同一林中的另一台服务器上托管。

**在将托管 AGPM 服务的计算机上安装 AGPM 服务器**

1.  使用域管理员组的成员帐户登录。

2.  启动 Microsoft 桌面优化包 CD，然后按照屏幕上的说明选择 "**高级组策略管理-服务器**"。

3.  在 "**欢迎**" 对话框中，单击 "**下一步**"。

4.  在 " **Microsoft 软件许可条款**" 对话框中，接受条款，然后单击 "**下一步**"。

5.  在 "**应用程序路径**" 对话框中，选择要在其中安装 AGPM 服务器的位置。 安装了 AGPM 服务器的计算机将托管 AGPM 服务并管理存档。 单击“下一步”****。

6.  在 "**存档路径**" 对话框中，选择存档相对于 AGPM 服务器的位置。 存档路径可以指向 AGPM 服务器或其他位置上的文件夹。 但是，你应该选择一个具有足够空间的位置来存储由此 AGPM 服务器管理的所有 Gpo 和历史记录数据。 单击“下一步”****。

7.  在 " **Agpm 服务帐户**" 对话框中，选择要在其下运行 AGPM 服务的服务帐户，然后单击 "**下一步**"。

    此帐户必须是域管理员组的成员，或者对于最低权限配置，由 AGPM 服务器管理的每个域中的以下组：

    -   组策略创建者所有者

    -   备份操作员

    此外，此帐户需要对以下文件夹的 "完全控制" 权限：

    -   AGPM 存档文件夹，当在本地驱动器上安装了 AGPM 服务器的安装期间，此权限会自动授予此权限。

    -   本地系统 temp 文件夹，通常为%windir%\\temp。

8.  在 "**存档所有者**" 对话框中，选择要向其分配 AGPM 管理员（完全控制）角色的帐户或组。 AGPM 管理员可以为其他组策略管理员分配 AGPM 角色和权限，以便稍后可以将 AGPM 管理员角色分配给其他组策略管理员。 对于此方案，选择要在 AGPM 管理员角色中提供的帐户。 单击“下一步”****。

9.  在 "**端口配置**" 对话框中，键入 AGPM 服务应侦听的端口。 不要清除 "**将端口例外添加到防火墙**" 复选框，除非手动配置端口例外或使用规则配置端口例外。 单击“下一步”****。

10. 在 "**语言**" 对话框中，选择要为 AGPM 服务器安装的一个或多个显示语言。

11. 单击 "**安装**"，然后单击 "**完成**" 退出设置向导。

    **小心** 不要通过操作系统中的 "**管理工具**和**服务**" 更改 AGPM 服务的设置。 这样做可能会阻止 AGPM 服务启动。 有关如何更改服务设置的信息，请参阅高级组策略管理的帮助。

     

### <a href="" id="bkmk-config2"></a>步骤2：安装 AGPM 客户端

每个组策略管理员（创建、编辑、部署、查看或删除 Gpo 的任何人）都必须在它们用于管理 Gpo 的计算机上安装 AGPM 客户端。 只有在安装了 AGPM 客户端的情况下，才会在组策略管理控制台中显示用于执行许多 GPO 管理任务的 "更改控制" 节点。 对于此方案，请在至少一台计算机上安装 AGPM 客户端。 无需在不执行组策略管理的最终用户的计算机上安装 AGPM 客户端。

**在组策略管理员的计算机上安装 AGPM 客户端**

1.  启动 Microsoft 桌面优化包 CD，然后按照屏幕上的说明选择 "**高级组策略管理-客户端**"。

2.  在 "**欢迎**" 对话框中，单击 "**下一步**"。

3.  在 " **Microsoft 软件许可条款**" 对话框中，接受条款，然后单击 "**下一步**"。

4.  在 "**应用程序路径**" 对话框中，选择要在其中安装 AGPM 客户端的位置。 单击“下一步”****。

5.  在 " **AGPM 服务器**" 对话框中，键入 AGPM 服务器的 DNS 名称或 IP 地址以及要连接到的端口。 AGPM 服务的默认端口为4600。 不要清除 "**通过防火墙允许 Microsoft 管理控制台**" 复选框，除非手动配置端口例外或使用规则配置端口例外。 单击“下一步”****。

6.  在 "**语言**" 对话框中，选择要为 AGPM 客户端安装的一个或多个显示语言。

7.  单击 "**安装**"，然后单击 "**完成**" 退出设置向导。

### <a href="" id="bkmk-config3"></a>步骤3：配置 AGPM 服务器连接

AGPM 存储每个受控制的组策略对象（GPO）的所有版本，即 AGPM 在中心存档中提供更改控制的每个 GPO。 这样，组策略管理员可以在不立即影响每个 GPO 的已部署版本的情况下查看和更改 Gpo。

在此步骤中，配置 AGPM 服务器连接并确保所有组策略管理员都连接到同一 AGPM 服务器。 （有关如何配置多台 AGPM 服务器的信息，请参阅高级组策略管理的帮助。）

**为所有组策略管理员配置 AGPM 服务器连接**

1.  在已安装了 AGPM 客户端的计算机上，使用你选择作为存档所有者的用户帐户登录。 此用户具有 AGPM 管理员的角色（"完全控制"）。

2.  单击 "**开始**"，指向 "**管理工具**"，然后单击 "**组策略管理**" 以打开 GPMC。

3.  编辑应用到所有组策略管理员的 GPO。

4.  在 "**组策略管理编辑器**" 窗口中，双击 **"用户配置**"、"**策略**"、"**管理模板**"、" **Windows 组件**" 和 " **AGPM**"。

5.  在 "详细信息" 窗格中，双击 " **AGPM：指定默认 Agpm 服务器（所有域）**"。

6.  在 "**属性**" 窗口中，选择 "**已启用**"，然后为托管存档的服务器键入 DNS 名称或 IP 地址以及端口（例如， **server.contoso.com:4600**）。 默认情况下，AGPM 服务使用端口4600。

7.  单击 **"确定**"，然后关闭 "**组策略管理编辑器**" 窗口。 更新组策略时，将为每个组策略管理员配置 AGPM 服务器连接。

### <a href="" id="bkmk-config4"></a>步骤4：配置电子邮件通知

作为 AGPM 管理员（完全控制），你可以指定在编辑者尝试创建、部署或删除 GPO 时，将向其发送包含请求的电子邮件的审批者和 AGPM 管理员的电子邮件地址。 您还可以确定发送这些邮件的别名。

**配置 AGPM 的电子邮件通知**

1.  在**组策略管理编辑器**中，导航到 "**更改控制**" 文件夹 

2.  在 "详细信息" 窗格中，单击 "**域委派**" 选项卡。

3.  在 "**发件人电子邮件地址**" 字段中，键入要从中发送通知的 AGPM 的电子邮件别名。

4.  在 "**收件人电子邮件地址**" 字段中，键入要向其分配审批者角色的用户帐户的电子邮件地址。

5.  在 " **SMTP 服务器**" 字段中，键入有效的 SMTP 邮件服务器。

6.  在 "**用户名**" 和 "**密码**" 字段中，键入有权访问 SMTP 服务的用户的凭据。 单击**应用**。

### <a href="" id="bkmk-config5"></a>步骤5：代理访问

作为 AGPM 管理员（完全控制），你可以委派域级别对 Gpo 的访问权限，并为每个组策略管理员的帐户分配角色。

**注意** 你还可以在 GPO 级别（而不是域级别）委派访问权限。 有关详细信息，请参阅高级组策略管理的帮助。

 

**重要提示** 应限制 "组策略创建者所有者" 组中的成员身份，以便它不能用于绕过对 Gpo 的访问的 AGPM 管理。 （在**组策略管理控制台**中，单击要在其中管理 gpo 的林和域中的 "**组策略对象**"，单击 "**委派**"，然后配置设置以满足组织的需要。）

 

**委派对整个域中的所有 Gpo 的访问权限**

1.  在 "**域委派**" 选项卡上，单击 "**添加**" 按钮，选择要用作审批者的组策略管理员的用户帐户，然后单击 **"确定"**。

2.  在 "**添加组或用户**" 对话框中，选择要向帐户分配该角色的**审批者**角色，然后单击 **"确定"**。 （此角色包括审阅者角色。）

3.  单击 "**添加**" 按钮，选择组策略管理员作为编辑器的用户帐户，然后单击 **"确定"**。

4.  在 "**添加组或用户**" 对话框中，选择要向帐户分配该角色的 "**编辑**者" 角色，然后单击 **"确定"**。 （此角色包括审阅者角色。）

5.  单击 "**添加**" 按钮，选择组策略管理员充当审阅者的用户帐户，然后单击 **"确定"**。

6.  在 "**添加组" 或 "用户**" 对话框中，选择**审阅者**角色以仅将该角色分配给帐户。

## 管理 Gpo 的步骤


必须完成以下步骤才能使用 AGPM 创建、编辑、审阅和部署 Gpo。 此外，你将创建一个模板，删除 GPO，然后还原已删除的 GPO。

[步骤1：创建 GPO](#bkmk-manage1)

[步骤2：编辑 GPO](#bkmk-manage2)

[步骤3：查看和部署 GPO](#bkmk-manage3)

[步骤4：使用模板创建 GPO](#bkmk-manage4)

[步骤5：删除和还原 GPO](#bkmk-manage5)

### <a href="" id="bkmk-manage1"></a>步骤1：创建 GPO

在具有多个组策略管理员的环境中，具有编辑器角色的环境可以请求创建新的 Gpo。 但是，该请求必须由拥有审批者角色的人员批准。

在此步骤中，使用具有编辑器角色的帐户以请求创建新的 GPO。 使用具有审批者角色的帐户，批准此请求以创建 GPO。

**请求通过 AGPM 创建和管理新的 GPO**

1.  在已安装了 AGPM 客户端的计算机上，使用分配了 AGPM 中的编辑器角色的用户帐户登录。

2.  在 "**组策略管理" 控制台**树中，单击要在其中管理 gpo 的林和域中的 "**更改控制**"。

3.  右键单击 "**更改控制**" 节点，然后单击 "**新建受控 GPO**"。

4.  在 "**新建受控 GPO** " 对话框中：

    1.  若要接收请求的副本，请在 "**抄送**" 字段中键入您的电子邮件地址。

    2.  键入**MyGPO**作为新 GPO 的名称。

    3.  键入新 GPO 的注释。

    4.  单击 "**创建实时**"，以便在批准后立即将新的 GPO 部署到生产环境。 单击**提交**。

5.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 新的 GPO 将显示在 "**挂起**" 选项卡上。

**批准创建 GPO 的挂起请求**

1.  在已安装了 AGPM 客户端的计算机上，使用具有 AGPM 中审批者角色的用户帐户登录。

2.  打开该帐户的电子邮件收件箱，请注意，您已收到一个来自 AGPM 别名的电子邮件，其中包含用于创建 GPO 的编辑器请求。

3.  在 "**组策略管理" 控制台**树中，单击要在其中管理 gpo 的林和域中的 "**更改控制**"。

4.  在 "**目录**" 选项卡上，单击 "**挂起**" 选项卡以显示 "挂起的 gpo"。

5.  右键单击 " **MyGPO**"，然后单击 "**批准**"。

6.  单击 **"是"** 确认审批，并将 GPO 移动到 "已**控制**" 选项卡。

### <a href="" id="bkmk-manage2"></a>步骤2：编辑 GPO

你可以使用 Gpo 配置计算机或用户设置，并将其部署到多台计算机或用户。 在此步骤中，你使用具有编辑器角色的帐户从存档中签出 GPO，脱机编辑 GPO，将已编辑的 GPO 签入存档，并向生产环境请求 GPO 部署。 在这种情况下，你可以在 GPO 中配置一个设置，要求密码长度至少为八个字符。

**从存档中签出 GPO 以进行编辑**

1.  在已安装了 AGPM 客户端的计算机上，使用在 AGPM 中具有 "编辑者" 角色的用户帐户登录。

2.  在 "**组策略管理" 控制台**树中，单击要在其中管理 gpo 的林和域中的 "**更改控制**"。

3.  在 "详细信息" 窗格中的 "**目录**" 选项卡上，单击 "**受控**" 选项卡以显示受控 gpo。

4.  右键单击 " **MyGPO**"，然后单击 "**签出**"。

5.  键入要在已签出的 GPO 的历史记录中显示的注释，然后单击 **"确定"**。

6.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 在 "**受控**" 选项卡上，将 GPO 的状态标识为 "**已签出**"。

**脱机编辑 GPO 并配置最小密码长度**

1.  在 "**受控**" 选项卡上，右键单击 " **MyGPO**"，然后单击 "**编辑**" 以打开 "**组策略管理编辑器**" 窗口，并更改该 GPO 的脱机副本。 对于此方案，请配置最小密码长度：

    1.  在 "**计算机配置**" 下，双击 "**策略**"、" **Windows 设置**"、"**安全设置**"、"**帐户策略**" 和 "**密码策略**"。

    2.  在 "详细信息" 窗格中，双击 "**最小密码长度**"。

    3.  在 "属性" 窗口中，选中 "**定义此策略设置**" 复选框，将字符数设置为**8**，然后单击 **"确定"**。

2.  关闭 "**组策略管理编辑器**" 窗口。

**将 GPO 签入存档**

1.  在 "**受控**" 选项卡上，右键单击 " **MyGPO** "，然后单击 "**签入**"。

2.  键入批注，然后单击 **"确定"**。

3.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 在 "**受控**" 选项卡上，将 GPO 的状态标识为 **"已签入**"。

**请求将 GPO 部署到生产环境**

1.  在 "**受控**" 选项卡上，右键单击 " **MyGPO** "，然后单击 "**部署**"。

2.  由于此帐户不是审批者或 AGPM 管理员，因此必须提交部署请求。 若要接收请求的副本，请在 "**抄送**" 字段中键入您的电子邮件地址。 键入要在 GPO 的历史记录中显示的注释，然后单击 "**提交**"。

3.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 **MyGPO**将显示在 "**挂起**" 选项卡上的 gpo 列表中。

### <a href="" id="bkmk-manage3"></a>步骤3：查看和部署 GPO

在此步骤中，你充当审批者，创建报表和分析 GPO 中的设置以及对设置的更改，以确定是否应批准这些设置。 评估 GPO 后，将其部署到生产环境，并将 GPO 链接到域或组织单位（OU）。 当为该域或 OU 中的计算机刷新组策略时，GPO 将生效。

**查看 GPO 中的设置**

1. 在安装了 AGPM 客户端的计算机上，使用为 AGPM 中的审批者角色分配的用户帐户进行登录。 任何具有审阅者角色（包括在所有其他角色中）的组策略管理员都可以查看 GPO 中的设置。

2. 打开帐户的电子邮件收件箱，请注意，你已收到来自 AGPM 别名的电子邮件，其中包含用于部署 GPO 的编辑器请求。

3. 在 "**组策略管理" 控制台**树中，单击要在其中管理 gpo 的林和域中的 "**更改控制**"。

4. 在 "详细信息" 窗格中的 "**目录**" 选项卡上，单击 "**挂起**" 选项卡。

5. 双击 " **MyGPO** " 以显示其历史记录。

6. 查看最新版本的 MyGPO 中的设置：

   1.  在 "**历史记录**" 窗口中，右键单击具有最近时间戳的 GPO 版本，单击 "**设置**"，然后单击 " **HTML 报表**" 以显示该 gpo 的设置摘要。

   2.  在 Web 浏览器中，单击 "**全部显示**" 以显示 GPO 中的所有设置。 关闭浏览器。

7. 将最新版本的 MyGPO 与签入到存档中的第一个版本进行比较：

   1. 在 "**历史记录**" 窗口中，单击具有最新时间戳的 GPO 版本。 按 CTRL，然后单击**计算机版本**不是 * * \\ * * * 的最旧 GPO 版本。

   2. 单击 "**差异**" 按钮。 "**帐户策略/密码策略**" 部分以绿色突出显示，并以 " **+ \**" 开头。 这表示仅在 GPO 的后一版本中配置该设置。

   3. 单击 "**帐户策略/密码策略**"。 "**最小密码长度**" 设置也将以绿色突出显示，并以 " **+ \**" 开头，以指示它仅在 GPO 的后版本中进行配置。

   4. 关闭 Web 浏览器。

**将 GPO 部署到生产环境**

1.  在 "**挂起**" 选项卡上，右键单击 " **MyGPO** "，然后单击 "**批准**"。

2.  键入要包含在 GPO 历史记录中的注释。

3.  单击**是**。 当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 GPO 已部署到生产环境。

**将 GPO 链接到域或组织单位**

1.  在 GPMC 中，右键单击要对其应用所配置 GPO 的域或组织单位（OU），然后单击 "**链接现有 gpo**"。

2.  在 "**选择 GPO** " 对话框中，单击 " **MyGPO**"，然后单击 **"确定"**。

### <a href="" id="bkmk-manage4"></a>步骤4：使用模板创建 GPO

在此步骤中，使用具有编辑器角色的帐户创建和使用模板。 该模板是 GPO 的静态版本，用作创建新 Gpo 的起始点。 虽然您无法编辑模板，但您可以基于模板创建新的 GPO。 模板对于快速创建包含许多相同策略设置的多个 Gpo 非常有用。

**基于现有 GPO 创建模板**

1.  在已安装了 AGPM 客户端的计算机上，使用在 AGPM 中分配有 "编辑者" 角色的用户帐户登录。

2.  在 "**组策略管理" 控制台**树中，单击要在其中管理 gpo 的林和域中的 "**更改控制**"。

3.  在 "详细信息" 窗格中的 "**目录**" 选项卡上，单击 "**受控**" 选项卡。

4.  右键单击 " **MyGPO**"，然后单击 "**另存为模板**"，创建一个模板，其中包含当前在 MyGPO 中的所有设置。

5.  键入**MyTemplate**作为模板名称和注释，然后单击 **"确定"**。

6.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 新模板将显示在 "**模板**" 选项卡上。

**请求通过 AGPM 创建和管理新的 GPO**

1.  单击 "**受控**" 选项卡。

2.  右键单击 "**更改控制**" 节点，然后单击 "**新建受控 GPO**"。

3.  在 "**新建受控 GPO** " 对话框中：

    1.  若要接收请求的副本，请在 "**抄送**" 字段中键入您的电子邮件地址。

    2.  键入**MyOtherGPO**作为新 GPO 的名称。

    3.  键入新 GPO 的注释。

    4.  单击 "**创建实时**"，以便在批准后立即将新的 GPO 部署到生产环境。

    5.  **在 "来自 GPO 模板**" 中，选择 " **MyTemplate**"。 单击**提交**。

4.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 新的 GPO 将显示在 "**挂起**" 选项卡上。

使用为审批者角色分配的帐户批准挂起的请求以创建 GPO （如步骤1中所执行的[操作）：创建 gpo](#bkmk-manage1)。 MyTemplate 包含您在 MyGPO 中配置的所有设置。 由于 MyOtherGPO 是使用 MyTemplate 创建的，因此它最初包含在创建 MyTemplate 时 MyGPO 包含的所有设置。 你可以通过生成差异报表来将 MyOtherGPO 与 MyTemplate 进行比较来确认。

**从存档中签出 GPO 以进行编辑**

1.  在已安装了 AGPM 客户端的计算机上，使用在 AGPM 中分配有 "编辑者" 角色的用户帐户登录。

2.  右键单击 " **MyOtherGPO**"，然后单击 "**签出**"。

3.  键入要在已签出的 GPO 的历史记录中显示的注释，然后单击 **"确定"**。

4.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 在 "**受控**" 选项卡上，将 GPO 的状态标识为 "**已签出**"。

**脱机编辑该 GPO 并配置帐户锁定时间**

1.  在 "**受控**" 选项卡上，右键单击 " **MyOtherGPO**"，然后单击 "**编辑**" 以打开 "**组策略管理编辑器**" 窗口，并更改该 GPO 的脱机副本。 对于此方案，请配置最小密码长度：

    1.  在 "**计算机配置**" 下，双击 "**策略**"、" **Windows 设置**"、"**安全设置**"、"**帐户策略**" 和 "**帐户锁定策略**"。

    2.  在 "详细信息" 窗格中，双击 "**帐户锁定时间**"。

    3.  在 "属性" 窗口中，选中 "**定义此策略设置**"，将 "持续时间" 设置为 " **30**分钟"，然后单击 **"确定"**。

2.  关闭 "**组策略管理编辑器**" 窗口。

在[步骤2：编辑 GPO](#bkmk-manage2)中，将 MyOtherGPO 签入存档并请求部署。 你可以使用差异报告将 MyOtherGPO 与 MyGPO 或 MyTemplate 进行比较。 任何包含审阅者角色的帐户（AGPM 管理员 \ [完全控制 \]、审批者、编辑者或审阅者）都可以生成报表。

**将 GPO 与另一个 GPO 和模板进行比较**

1.  要比较 MyGPO 和 MyOtherGPO，请执行以下操作：

    1.  在 "**受控**" 选项卡上，单击 " **MyGPO**"。 按 CTRL，然后单击 " **MyOtherGPO**"。

    2.  右键单击 " **MyOtherGPO**"，指向 "**差异**"，然后单击 " **HTML 报表**"。

2.  要比较 MyOtherGPO 和 MyTemplate，请执行以下操作：

    1.  在 "**受控**" 选项卡上，单击 " **MyOtherGPO**"。

    2.  右键单击 " **MyOtherGPO**"，指向 "**差异**"，然后单击 "**模板**"。

    3.  选择 " **MyTemplate** " 和 " **HTML 报表**"，然后单击 **"确定"**。

### <a href="" id="bkmk-manage5"></a>步骤5：删除和还原 GPO

在此步骤中，你充当审批者以删除 GPO。

**删除 GPO**

1.  在已安装了 AGPM 客户端的计算机上，使用分配了审批者角色的用户帐户登录。

2.  在 "**组策略管理" 控制台**树中，单击要在其中管理 gpo 的林和域中的 "**更改控制**"。

3.  在 "**目录**" 选项卡上，单击 "**受控**" 选项卡以显示受控 gpo。

4.  右键单击 " **MyGPO**"，然后单击 "**删除**"。 单击 "**从存档和生产中删除 GPO** " 以删除存档中的版本和生产环境中部署的 GPO 的部署版本。

5.  键入要显示在 GPO 审核跟踪中的注释，然后单击 **"确定"**。

6.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 GPO 将从 "**受控**" 选项卡中删除，并显示在 "**回收站**" 选项卡上，可在其中还原或销毁。

有时，你可能会在删除仍需要的 GPO 后发现。 在此步骤中，你充当审批者以还原已删除的 GPO。

**还原已删除的 GPO**

1.  在 "**目录**" 选项卡上，单击 "**回收站**" 选项卡以显示已删除的 gpo。

2.  右键单击 " **MyGPO**"，然后单击 "**还原**"。

3.  键入要在 GPO 的历史记录中显示的注释，然后单击 **"确定"**。

4.  当**AGPM 进度**窗口指示整个进度完成时，单击 "**关闭**"。 该 GPO 将从 "**回收站**" 选项卡中删除，并显示在 "**受控**" 选项卡上。

    **注意** 将 GPO 还原到存档不会自动将其重新部署到生产环境。 若要将 GPO 返回到生产环境，请按照[步骤3部署 gpo：查看和部署 gpo](#bkmk-manage3)。

     

在编辑和部署 GPO 之后，你可能会发现对 GPO 所做的最新更改会导致出现问题。 在此步骤中，你充当审批者以回退到 GPO 的早期版本。 你可以回退到 GPO 历史记录中的任意版本。 你可以使用批注和标签来标识已知的有效版本以及进行特定的更改。

**回滚到 GPO 的早期版本**

1.  在 "**目录**" 选项卡上，单击 "**受控**" 选项卡以显示受控 gpo。

2.  双击 " **MyGPO** " 以显示其历史记录。

3.  右键单击要部署的版本，单击 "**部署**"，然后单击 **"是"**。

4.  当**进度**窗口指示整个进度完成时，单击 "**关闭**"。 在 "**历史记录**" 窗口中，单击 "**关闭**"。

    **注意** 若要验证重新部署的版本是否为所需的版本，请检查两个版本的差异报告。 在 GPO 的 "**历史记录**" 窗口中，选择两个版本，右键单击它们，指向 "**差异**"，然后单击 " **HTML 报表**" 或 " **XML 报表**"。

     

 

 





