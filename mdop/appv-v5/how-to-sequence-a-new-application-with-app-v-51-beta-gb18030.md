---
title: 如何使用 App-V 5.1 对新应用程序进行排序
description: 如何使用 App-V 5.1 对新应用程序进行排序
author: dansimp
ms.assetid: 7d7699b1-0cb8-450d-94e7-5af937e16c21
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, appcompat, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 06/16/2016
ms.openlocfilehash: 43edd9357e31f4884ed7baec3d35fa01bf2abe54
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/26/2020
ms.locfileid: "10798365"
---
# 如何使用 App-V 5.1 对新应用程序进行排序


**在开始排序之前查看或执行此操作**

1.  确定要创建的虚拟化应用程序包的类型：

    <table>
    <colgroup>
    <col width="50%" />
    <col width="50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th align="left">应用程序类型</th>
    <th align="left">描述</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td align="left"><p>Standard</p></td>
    <td align="left"><p>创建一个包含应用程序或一组应用程序的程序包。 这是大多数应用程序类型的首选选项。</p></td>
    </tr>
    <tr class="even">
    <td align="left"><p>加载项或插件</p></td>
    <td align="left"><p>创建扩展标准应用程序（例如 Microsoft Excel 插件）的功能的程序包。 此外，你可以为本机安装的应用程序或使用连接组链接的其他程序包使用插件。</p></td>
    </tr>
    <tr class="odd">
    <td align="left"><p>中间件</p></td>
    <td align="left"><p>创建标准应用程序（例如，Java）所需的程序包。 中间件程序包用于通过使用连接组链接到其他程序包。</p></td>
    </tr>
    </tbody>
    </table>



2.  将所有所需的安装文件复制到运行 sequencer 的计算机。

3.  在对应用程序进行排序之前制作虚拟环境的备份映像，并在每次完成应用程序序列化后恢复到该映像。

4.  查看以下项目：

    -   如果应用程序安装程序将安全访问更改为新的或现有的文件或目录，则不会在程序包中捕获这些更改。

    -   如果已为虚拟化程序包的目标卷禁用短路径，则还必须将程序包序列化到已创建且仍具有短路径禁用的卷。 它不能是系统卷。

> [!NOTE]  
> App-v 5. x Sequencer 无法序列文件名与 "CO_ x" 匹配的应用 &lt; 程序 &gt; ，其中 x 是任何数字。 将生成错误0x8007139F。

**对新标准应用程序进行序列化**

1.  在运行 sequencer 的计算机上，单击 "**所有程序**"，然后单击 " **Microsoft**application virtualization sequencer"，然后单击 " **microsoft application virtualization sequencer**"。

2.  在排序器中，单击 "**创建新的虚拟应用程序包**"。 选择 "**创建程序包（默认）**"，然后单击 "**下一步**"。

3.  在 "**准备计算机**" 页面上，查看可能导致程序包创建失败或可能导致程序包包含不必要的数据的问题。 您应该先解决所有潜在问题，然后再继续。 进行更正后，单击 "**刷新**" 以显示更新的信息。 解决所有潜在问题后，单击 "**下一步**"。

    > [!IMPORTANT]
    > 如果需要禁用病毒扫描软件，应首先扫描运行 sequencer 的计算机，以确保不会将不需要的或恶意文件添加到程序包。



~~~
> [!NOTE]  
> There is currently no way to disable Windows Defender in Windows 10. If you receive a warning, you can safely ignore it. It is unlikely that Windows Defender will affect sequencing at all.
~~~



4. 在 "**应用程序类型**" 页面上，单击 "**标准应用程序（默认）** " 复选框，然后单击 "**下一步**"。

5. 在 "**选择安装程序**" 页面上，单击 "**浏览**" 并指定应用程序的安装文件。

   > [!NOTE]  
   > 如果指定的应用程序安装程序修改了对文件或目录的安全访问权限（现有的或新的），则不会将关联的更改捕获到程序包中。



~~~
If the application does not have an associated installer file and you plan to run all installation steps manually, select the **Perform a Custom Installation** check box, and then Click **Next**.
~~~

6. 在 "**程序包名称**" 页面上，键入将与该程序包关联的名称。 使用有助于标识将添加到程序包的应用程序用途和版本的名称。 程序包名称将显示在 app-v 5.0 管理控制台中。

   单击“下一步”****。

7. 在 "**安装**" 页面上，当 sequencer 和应用程序安装准备就绪时，可以继续安装应用程序，以便排序器可以监视安装过程。

   > [!IMPORTANT]
   > 你应该始终将应用程序安装到安全位置，并确保在监视期间没有其他用户登录到运行 sequencer 的计算机。



~~~
Use the application's installation process to perform the installation. If additional installation files must be run as part of the installation, click **Run** to locate and run the additional installation files. When you are finished with the installation, select **I am finished installing**. Click **Next**.
~~~

8. 在 "**安装**" 页面上，在 sequencer 配置虚拟化应用程序包时等待。

9. 在 "**配置软件**" 页面上，选择运行程序包中包含的程序。 此步骤允许你在目标计算机上部署和运行程序包之前完成任何必要的许可证或配置任务。 若要一次运行所有程序，请至少选择一个程序，然后单击 "**全部运行**"。 若要运行特定程序，请选择该程序或程序，然后单击 "**运行所选**"。 完成所需的配置任务，然后关闭应用程序。 您可能需要等待几分钟才能让所有程序运行。

   > [!NOTE]  
   > 若要对列表中不可用的任何应用程序运行第一次使用任务，请打开该应用程序。 相关信息将在此步骤中捕获。



~~~
Click **Next**.
~~~

10. 在 "**安装报告**" 页面上，您可以查看刚刚排序的虚拟化应用程序包的相关信息。 在**其他信息**中，双击事件以获取更详细的信息。 若要继续，请单击 "**下一步**"。

11. 将显示 "**自定义**" 页面。 如果已完成安装和配置虚拟应用程序，请选择 "**立即停止**"，然后跳到此过程的步骤14。 若要执行下列任一自定义操作，请选择 "**自定义**"。

    -   准备用于流式处理的虚拟包。 流改进了在目标计算机上运行虚拟应用程序包时的体验。

    -   指定可以运行此程序包的操作系统。

    单击“下一步”****。

12. 在 "**流**" 页面上，运行每个程序，以便可以在目标计算机上对其进行优化和更高效地运行。 运行所有应用程序可能需要几分钟的时间。 在所有应用程序运行后，关闭每个应用程序，然后单击 "**下一步**"。

   > [!NOTE]  
   > 如果在此步骤中不打开任何应用程序，则默认流方法为按需流式传递。 这意味着将按位下载应用程序，直到可以打开应用程序，然后根据后台加载的配置，将加载应用程序的其余部分。



13. 在 "**目标操作系统**" 页面上，指定可运行此程序包的操作系统。 若要允许环境中的所有受支持的操作系统运行此程序包，请选择 "**允许此程序包在任何操作系统上运行**"。 若要将此程序包配置为仅在特定操作系统上运行，请选择 "**仅允许此程序包在以下操作系统上运行**"，然后选择可以运行此程序包的操作系统。 单击“下一步”****。

   > [!IMPORTANT]
   > 请确保你在此处指定的操作系统由你正在排序的应用程序支持。



14. 将显示 "**创建程序包**" 页面。 若要在不保存的情况下修改程序包，请选择 **"继续" 以在不保存的情况下使用程序包编辑器修改程序包**。 此选项将在 sequencer 控制台中打开程序包，以便你可以在保存包之前对其进行修改。 单击“下一步”****。

   若要立即保存程序包，请选择 **"立即保存程序包"** （默认）。 添加要与程序包关联的可选**注释**。 注释适用于标识程序版本和有关程序包的其他信息。

   > [!IMPORTANT]
   > 系统不支持**批注**和**说明**中的不可打印字符。



~~~
The default **Save Location** is also displayed on this page. To change the default location, click **Browse** and specify the new location. Click **Create**.
~~~

15. 将显示**完成**页。 根据需要查看 "**虚拟应用程序包" 报表**窗格中的信息，然后单击 "**关闭**"。 也可以在创建程序包的目录中的**Report.xml**文件中找到此信息。

   程序包现在在 sequencer 中可用。

   > [!IMPORTANT]
   > 成功创建虚拟应用程序包后，不能在运行 sequencer 的计算机上运行虚拟应用程序包。



**对加载项或插件应用程序进行排序**

1. > [!NOTE]  
   > 在执行以下过程之前，请在运行 sequencer 的计算机上本地安装父应用程序。 或者，如果你已将父应用程序虚拟化，则可以按照加载项或插件工作流中的步骤将父应用程序解压缩到计算机上。
   >
   > 例如，如果要为 Microsoft Excel 的插件进行排序，请在运行 sequencer 的计算机上本地安装 Microsoft Excel。 还在目标计算机上安装应用程序的同一目录中安装父应用程序。 如果要对现有虚拟应用程序包使用插件或加载项，请在创建父虚拟应用程序包时使用的同一虚拟应用程序驱动器上安装该应用程序。



~~~
On the computer that runs the sequencer, click **All Programs**, and then Click **Microsoft Application Virtualization**, and then click **Microsoft Application Virtualization Sequencer**.
~~~

2. *<strong><em>在排序器中，单击 "* </em> 创建新的虚拟应用程序包" </strong> 。 选择 "**创建程序包（默认）**"，然后单击 "**下一步**"。

3. 在 "**准备计算机**" 页面上，查看可能导致程序包创建失败或可能导致程序包包含不必要的数据的问题。 您应该先解决所有潜在问题，然后再继续。 进行更正后，单击 "**刷新**" 以显示更新的信息。 解决所有潜在问题后，单击 "**下一步**"。

   > [!IMPORTANT]
   > 如果需要禁用病毒扫描软件，应首先扫描运行 sequencer 的计算机，以确保不会将不需要的或恶意文件添加到程序包。



4. 在 "**应用程序类型**" 页面上，选择 "加载项"**或 "插件**"，然后单击 "**下一步**"。

5. 在 "**选择安装程序**" 页面上，单击 "**浏览**" 并为加载项或插件指定安装文件。 如果加载项或插件没有关联的安装程序文件，并且你计划手动运行所有安装步骤，请选中 "**选择此选项以执行自定义安装**" 复选框，然后单击 "**下一步**"。

6. 在 "**安装主页**" 上，确保在运行 sequencer 的计算机上安装了主应用程序。 或者，你可以展开本地保存在运行 sequencer 的计算机上的现有程序包。 若要执行此操作，请单击 "**展开包**"，然后选择程序包。 展开或安装父程序后，选择 **"我已安装主要父程序"**。

   单击“下一步”****。

7. 在 "**程序包名称**" 页面上，键入将与该程序包关联的名称。 使用有助于标识将添加到程序包的应用程序用途和版本的名称。 程序包名称将显示在 app-v 5.0 管理控制台中。

   单击“下一步”****。

8. 在 "**安装**" 页面上，当 sequencer 和应用程序安装准备就绪时，可以继续安装插件或加载项应用程序，以便排序器可以监视安装过程。 使用应用程序的安装过程执行安装。 如果必须在安装过程中运行其他安装文件，请单击 "**运行**"，然后找到并运行其他安装文件。 完成安装后，选择 "**我已完成安装**"，然后单击 "**下一步**"。

9. 在 "**安装报告**" 页面上，您可以查看刚刚排序的虚拟应用程序包的相关信息。 有关**其他信息**中显示的信息的更多详细说明，请双击该事件。 查看信息后，单击 "**下一步**"。

10. 将显示 "**自定义**" 页面。 如果已完成安装和配置虚拟应用程序，请选择 "**立即停止**"，然后跳到此过程的步骤12。 若要执行下列任一自定义操作，请选择 "**自定义**"。

    -   优化数据包在慢速或不可靠网络上的运行方式。

    -   指定可以运行此程序包的操作系统。

    单击“下一步”****。

11. 在 "**流**" 页面上，运行每个程序，以便可以在目标计算机上对其进行优化和更高效地运行。 流改进了在高延迟网络上的目标计算机上运行虚拟应用程序包时的体验。 运行所有应用程序可能需要几分钟的时间。 运行所有应用程序后，关闭每个应用程序。 您还可以通过选中 "**强制下载应用程序**" 复选框，将程序包配置为在打开前需要完全下载。 单击“下一步”****。

    > [!NOTE]  
    > 如有必要，您可以在执行此步骤期间停止应用程序的加载。 在 "**应用程序启动**" 对话框中，单击 "**停止**"，然后选择其中一个复选框： "**停止所有应用程序**" 或 "**仅停止此应用程序**"。



12. 在 "**目标操作系统**" 页面上，指定可运行此程序包的操作系统。 若要允许环境中的所有受支持的操作系统运行此程序包，请选中 "**允许此程序包在任何操作系统上运行**" 复选框。 若要将此程序包配置为仅在特定操作系统上运行，请选中 "**仅允许此程序包在下列操作系统上运行**" 复选框，然后选择可以运行此程序包的操作系统。 单击“下一步”****。

13. 将显示 "**创建程序包**" 页面。 若要在不保存的情况下修改程序包，请选择 **"继续使用程序包编辑器修改程序包而不保存**" 复选框。 此选项将在 sequencer 控制台中打开程序包，以便你可以在保存包之前对其进行修改。 单击“下一步”****。

    若要立即保存程序包，请选择 **"立即保存程序包"**。 （可选）添加将与程序包关联的**说明**。 说明适用于标识有关程序包的版本和其他信息。

    > [!IMPORTANT]
    > 系统不支持批注和说明中的不可打印字符。



~~~
The default **Save Location** is also displayed on this page. To change the default location, click **Browse** and specify the new location. Click **Create**.
~~~

**对中间件应用程序进行排序**

1. 在运行 sequencer 的计算机上，单击 "**所有程序**"，然后单击 " **Microsoft**application virtualization sequencer"，然后单击 " **microsoft application virtualization sequencer**"。

2. *<strong><em>在排序器中，单击 "* </em> 创建新的虚拟应用程序包" </strong> 。 选择 "**创建程序包（默认）**"，然后单击 "**下一步**"。

3. 在 "**准备计算机**" 页面上，查看可能导致程序包创建失败或可能导致程序包包含不必要的数据的问题。 您应该先解决所有潜在问题，然后再继续。 进行更正后，单击 "**刷新**" 以显示更新的信息。 解决所有潜在问题后，单击 "**下一步**"。

   > [!IMPORTANT]
   > 如果需要禁用病毒扫描软件，应首先扫描运行 app-v 5.0 Sequencer 的计算机，以确保不会向程序包添加不需要的文件或恶意文件。



4. 在 "**应用程序类型**" 页面上，选择 "**中间件**"，然后单击 "**下一步**"。

5. 在 "**选择安装程序**" 页面上，单击 "**浏览**" 并指定应用程序的安装文件。 如果应用程序没有关联的安装程序文件，并且你计划手动运行所有安装步骤，请选中 "**选择此选项以执行自定义安装**" 复选框，然后单击 "**下一步**"。

6. 在 "**程序包名称**" 页面上，键入将与该程序包关联的名称。 使用有助于标识将添加到程序包的应用程序用途和版本的名称。 程序包名称将显示在 app-v 5.0 管理控制台中。

   单击“下一步”****。

7. 在 "**安装**" 页面上，当 sequencer 和中间件应用程序安装程序准备就绪时，可以继续安装应用程序，以便排序器可以监视安装过程。 使用应用程序的安装过程执行安装。 如果必须在安装过程中运行其他安装文件，请单击 "**运行**" 以查找并运行其他安装文件。 完成安装后，选中 "**已完成安装**" 复选框，然后单击 "**下一步**"。

8. 在 "**安装**" 页面上，在 sequencer 配置虚拟应用程序包时等待。

9. 在 "**安装报告**" 页面上，你可以查看你刚刚排序过的虚拟应用程序包的相关信息。 在**其他信息**中，双击事件以获取更详细的信息。 若要继续，请单击 "**下一步**"。

10. 在 "**目标操作系统**" 页面上，指定可运行此程序包的操作系统。 若要在你的环境中启用所有支持的操作系统以运行此程序包，请选中 "**允许此程序包在任何操作系统上运行**" 复选框。 若要将此程序包配置为仅在特定操作系统上运行，请选中 "**仅允许此程序包在下列操作系统上运行**" 复选框，然后选择可以运行此程序包的操作系统。 单击“下一步”****。

11. 在 "**创建程序包**" 页面上显示。 若要在不保存的情况下修改程序包，请选择 **"继续" 以在不保存的情况下使用程序包编辑器修改程序包**。 此选项将在 sequencer 控制台中打开程序包，以便你可以在保存包之前对其进行修改。 单击“下一步”****。

    若要立即保存程序包，请选择 **"立即保存程序包"**。 （可选）添加与程序包关联的**说明**。 说明适用于标识程序版本和有关程序包的其他信息。

    > [!IMPORTANT]
    > 系统不支持批注和说明中的不可打印字符。



~~~
The default **Save Location** is also displayed on this page. To change the default location, click **Browse** and specify the new location. Click **Create**.
~~~

12. 将显示**完成**页。 根据需要查看 "**虚拟应用程序包" 报表**窗格中的信息，然后单击 "**关闭**"。 此信息也可在此过程的步骤11中指定的目录中的**Report.xml**文件中使用。

   程序包现在在 sequencer 中可用。 若要编辑程序包属性，请单击 "**编辑 \ [包名称 \]**"。

   > [!IMPORTANT]
   > 成功创建虚拟应用程序包后，不能在运行 sequencer 的计算机上运行虚拟应用程序包。



~~~
**Got a suggestion for App-V**? Add or vote on suggestions [here](http://appv.uservoice.com/forums/280448-microsoft-application-virtualization). **Got an App-V issue?** Use the [App-V TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopappv).
~~~

## 相关主题


[App-V 5.1 的操作](operations-for-app-v-51.md)









